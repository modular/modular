##===----------------------------------------------------------------------===##
# Copyright (c) 2025, Modular Inc. All rights reserved.
#
# Licensed under the Apache License v2.0 with LLVM Exceptions:
# https://llvm.org/LICENSE.txt
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
##===----------------------------------------------------------------------===##

name: bench_matmul
file: $KERNEL_BENCHMARKS_ROOT/gpu/bench_matmul.mojo
common: &common
- name: bench_matmul
  AUTOTUNING_MODE: true
  TUNE_CLUSTER_DIM_X: 2
  TUNE_CLUSTER_DIM_Z: 1
  TUNE_RASTER_ORDER: 1
  dtype: DType.float8_e4m3fn
params:

- <<: *common
  TUNE_BM: 128
  TUNE_BN: 112
  TUNE_CLUSTER_DIM_Y: 1
  TUNE_BLOCK_SWIZZLE_SIZE: 8
  M: 150
  K: 4096
  N: 16384
- <<: *common
  TUNE_BM: 128
  TUNE_BN: 112
  TUNE_CLUSTER_DIM_Y: 1
  TUNE_BLOCK_SWIZZLE_SIZE: 4
  M: 150
  K: 13312
  N: 16384
- <<: *common
  TUNE_BM: 64
  TUNE_BN: 64
  TUNE_CLUSTER_DIM_Y: 1
  TUNE_BLOCK_SWIZZLE_SIZE: 1
  M: 150
  K: 16384
  N: 4608
- <<: *common
  TUNE_BM: 128
  TUNE_BN: 96
  TUNE_CLUSTER_DIM_Y: 1
  TUNE_BLOCK_SWIZZLE_SIZE: 1
  M: 150
  K: 16384
  N: 26624
- <<: *common
  TUNE_BM: 128
  TUNE_BN: 112
  TUNE_CLUSTER_DIM_Y: 1
  TUNE_BLOCK_SWIZZLE_SIZE: 0
  M: 225
  K: 4096
  N: 16384
- <<: *common
  TUNE_BM: 128
  TUNE_BN: 112
  TUNE_CLUSTER_DIM_Y: 1
  TUNE_BLOCK_SWIZZLE_SIZE: 1
  M: 225
  K: 13312
  N: 16384
- <<: *common
  TUNE_BM: 64
  TUNE_BN: 64
  TUNE_CLUSTER_DIM_Y: 1
  TUNE_BLOCK_SWIZZLE_SIZE: 2
  M: 225
  K: 16384
  N: 4608
- <<: *common
  TUNE_BM: 128
  TUNE_BN: 96
  TUNE_CLUSTER_DIM_Y: 1
  TUNE_BLOCK_SWIZZLE_SIZE: 1
  M: 225
  K: 16384
  N: 26624
- <<: *common
  TUNE_BM: 64
  TUNE_BN: 112
  TUNE_CLUSTER_DIM_Y: 1
  TUNE_BLOCK_SWIZZLE_SIZE: 8
  M: 300
  K: 4096
  N: 16384
- <<: *common
  TUNE_BM: 64
  TUNE_BN: 112
  TUNE_CLUSTER_DIM_Y: 1
  TUNE_BLOCK_SWIZZLE_SIZE: 0
  M: 300
  K: 13312
  N: 16384
- <<: *common
  TUNE_BM: 64
  TUNE_BN: 96
  TUNE_CLUSTER_DIM_Y: 1
  TUNE_BLOCK_SWIZZLE_SIZE: 0
  M: 300
  K: 16384
  N: 4608
- <<: *common
  TUNE_BM: 64
  TUNE_BN: 112
  TUNE_CLUSTER_DIM_Y: 1
  TUNE_BLOCK_SWIZZLE_SIZE: 1
  M: 300
  K: 16384
  N: 26624
- <<: *common
  TUNE_BM: 128
  TUNE_BN: 112
  TUNE_CLUSTER_DIM_Y: 1
  TUNE_BLOCK_SWIZZLE_SIZE: 1
  M: 450
  K: 4096
  N: 16384
- <<: *common
  TUNE_BM: 128
  TUNE_BN: 112
  TUNE_CLUSTER_DIM_Y: 1
  TUNE_BLOCK_SWIZZLE_SIZE: 1
  M: 450
  K: 13312
  N: 16384
- <<: *common
  TUNE_BM: 128
  TUNE_BN: 64
  TUNE_CLUSTER_DIM_Y: 1
  TUNE_BLOCK_SWIZZLE_SIZE: 8
  M: 450
  K: 16384
  N: 4608
- <<: *common
  TUNE_BM: 128
  TUNE_BN: 120
  TUNE_CLUSTER_DIM_Y: 1
  TUNE_BLOCK_SWIZZLE_SIZE: 1
  M: 450
  K: 16384
  N: 26624
- <<: *common
  TUNE_BM: 64
  TUNE_BN: 112
  TUNE_CLUSTER_DIM_Y: 1
  TUNE_BLOCK_SWIZZLE_SIZE: 1
  M: 600
  K: 4096
  N: 16384
- <<: *common
  TUNE_BM: 64
  TUNE_BN: 112
  TUNE_CLUSTER_DIM_Y: 1
  TUNE_BLOCK_SWIZZLE_SIZE: 1
  M: 600
  K: 13312
  N: 16384
- <<: *common
  TUNE_BM: 128
  TUNE_BN: 96
  TUNE_CLUSTER_DIM_Y: 1
  TUNE_BLOCK_SWIZZLE_SIZE: 1
  M: 600
  K: 16384
  N: 4608
- <<: *common
  TUNE_BM: 128
  TUNE_BN: 112
  TUNE_CLUSTER_DIM_Y: 1
  TUNE_BLOCK_SWIZZLE_SIZE: 1
  M: 600
  K: 16384
  N: 26624
- <<: *common
  TUNE_BM: 128
  TUNE_BN: 112
  TUNE_CLUSTER_DIM_Y: 1
  TUNE_BLOCK_SWIZZLE_SIZE: 1
  M: 750
  K: 4096
  N: 16384
- <<: *common
  TUNE_BM: 128
  TUNE_BN: 112
  TUNE_CLUSTER_DIM_Y: 1
  TUNE_BLOCK_SWIZZLE_SIZE: 1
  M: 750
  K: 13312
  N: 16384
- <<: *common
  TUNE_BM: 128
  TUNE_BN: 96
  TUNE_CLUSTER_DIM_Y: 1
  TUNE_BLOCK_SWIZZLE_SIZE: 1
  M: 750
  K: 16384
  N: 4608
- <<: *common
  TUNE_BM: 128
  TUNE_BN: 112
  TUNE_CLUSTER_DIM_Y: 1
  TUNE_BLOCK_SWIZZLE_SIZE: 1
  M: 750
  K: 16384
  N: 26624
- <<: *common
  TUNE_BM: 128
  TUNE_BN: 128
  TUNE_CLUSTER_DIM_Y: 1
  TUNE_BLOCK_SWIZZLE_SIZE: 1
  M: 2048
  K: 4096
  N: 16384
- <<: *common
  TUNE_BM: 128
  TUNE_BN: 128
  TUNE_CLUSTER_DIM_Y: 1
  TUNE_BLOCK_SWIZZLE_SIZE: 1
  M: 2048
  K: 13312
  N: 16384
- <<: *common
  TUNE_BM: 128
  TUNE_BN: 128
  TUNE_CLUSTER_DIM_Y: 1
  TUNE_BLOCK_SWIZZLE_SIZE: 1
  M: 2048
  K: 16384
  N: 4608
- <<: *common
  TUNE_BM: 128
  TUNE_BN: 120
  TUNE_CLUSTER_DIM_Y: 1
  TUNE_BLOCK_SWIZZLE_SIZE: 1
  M: 2048
  K: 16384
  N: 26624
- <<: *common
  TUNE_BM: 128
  TUNE_BN: 128
  TUNE_CLUSTER_DIM_Y: 1
  TUNE_BLOCK_SWIZZLE_SIZE: 1
  M: 4096
  K: 4096
  N: 16384
- <<: *common
  TUNE_BM: 128
  TUNE_BN: 128
  TUNE_CLUSTER_DIM_Y: 1
  TUNE_BLOCK_SWIZZLE_SIZE: 1
  M: 4096
  K: 13312
  N: 16384
- <<: *common
  TUNE_BM: 128
  TUNE_BN: 128
  TUNE_CLUSTER_DIM_Y: 1
  TUNE_BLOCK_SWIZZLE_SIZE: 1
  M: 4096
  K: 16384
  N: 4608
- <<: *common
  TUNE_BM: 128
  TUNE_BN: 104
  TUNE_CLUSTER_DIM_Y: 1
  TUNE_BLOCK_SWIZZLE_SIZE: 8
  M: 4096
  K: 16384
  N: 26624
- <<: *common
  TUNE_BM: 128
  TUNE_BN: 128
  TUNE_CLUSTER_DIM_Y: 1
  TUNE_BLOCK_SWIZZLE_SIZE: 1
  M: 6144
  K: 4096
  N: 16384
- <<: *common
  TUNE_BM: 128
  TUNE_BN: 128
  TUNE_CLUSTER_DIM_Y: 1
  TUNE_BLOCK_SWIZZLE_SIZE: 8
  M: 6144
  K: 13312
  N: 16384
- <<: *common
  TUNE_BM: 128
  TUNE_BN: 128
  TUNE_CLUSTER_DIM_Y: 1
  TUNE_BLOCK_SWIZZLE_SIZE: 8
  M: 6144
  K: 16384
  N: 4608
- <<: *common
  TUNE_BM: 128
  TUNE_BN: 120
  TUNE_CLUSTER_DIM_Y: 1
  TUNE_BLOCK_SWIZZLE_SIZE: 4
  M: 6144
  K: 16384
  N: 26624
- <<: *common
  TUNE_BM: 128
  TUNE_BN: 128
  TUNE_CLUSTER_DIM_Y: 1
  TUNE_BLOCK_SWIZZLE_SIZE: 1
  M: 8192
  K: 4096
  N: 16384
- <<: *common
  TUNE_BM: 128
  TUNE_BN: 112
  TUNE_CLUSTER_DIM_Y: 1
  TUNE_BLOCK_SWIZZLE_SIZE: 8
  M: 8192
  K: 13312
  N: 16384
- <<: *common
  TUNE_BM: 128
  TUNE_BN: 128
  TUNE_CLUSTER_DIM_Y: 1
  TUNE_BLOCK_SWIZZLE_SIZE: 8
  M: 8192
  K: 16384
  N: 4608
- <<: *common
  TUNE_BM: 128
  TUNE_BN: 128
  TUNE_CLUSTER_DIM_Y: 1
  TUNE_BLOCK_SWIZZLE_SIZE: 8
  M: 8192
  K: 16384
  N: 26624
